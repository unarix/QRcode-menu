@page
@model IndexModel
@{
    ViewData["Title"] = "Menu Sala Vip";
}

<div>
    <img class="d-block mx-auto mb-4" src="https://www.aeropuertosvipclub.com.ar/imgs/logo-1x.png" alt="" width="150px">
</div>

<form method="post" id="myForm" class="needs-validation" novalidate>

<div class="order-md-2 mb-4">
        @{

            @if (@Model.pedidos.Equals(""))
            {
                <p class="text-muted text-center">Seleccione las cantidades en el menu siguiente y precione en enviar para finalizar el pedido</p>
                <br>

                int counter = 0;

                @foreach (var type in Model.types)
                {

                    <h4 class="d-flex justify-content-between align-items-center mb-3">
                        <span class="text-muted">@Html.DisplayFor(modelItem => type.titulo)</span>
                        <!--span class="badge badge-secondary badge-pill">@Html.DisplayFor(modelItem => type.descripcion)</span-->
                    </h4>

                    <ul class="list-group mb-3">
                    @foreach (var item in type.items)
                    {
                        <li class="list-group-item d-flex justify-content-between lh-condensed">
                        <div>
                            <h5 class="my-0">@Html.DisplayFor(modelItem => item.titulo_es)</h5>
                            <small class="text-muted">@Html.DisplayFor(modelItem => item.titulo_en) ・ </small>
                            <small class="text-muted">@Html.DisplayFor(modelItem => item.titulo_pt)</small>
                        </div>

                        <spam style="width:120px;"><input id="selected_@counter" name="@Html.DisplayFor(modelItem => item.titulo_es)" type="number" value="0" min="0" max="20" step="1"/></spam>
                        </li>
                        counter = counter + 1;
                    }
                    </ul>
                }
                
                <h6 class="d-flex justify-content-between align-items-center mb-3">
                <span class="text-muted">Algo que quieras agregar? </span>
                <span class="badge badge-secondary badge-pill"></span>
                </h6>
                
                <div class="input-group">
                    <input type="text" class="form-control" placeholder="Comentario">
                </div>
                <br>
                <div>
                    <button type="button" onclick="armarTexto();" class="btn btn-gold btn-lg btn-block" >Enviar</button>
                </div>
            }
            else
            {
                <p>@Html.Raw(Model.pedidos)</p>
                <div>
                    <button type="button" onclick="window.location='https://www.aeropuertosvipclub.com.ar/';"  class="btn btn-success btn-lg btn-block" >Gracias!</button>
                </div>
            }
        }

        <input type="text" style="visibility: hidden;" id="pedidos" class="form-control" asp-for="pedidos" placeholder="">
</div>
</form>

<script>
    $("input[type='number']").inputSpinner()
</script>
<script>
    function armarTexto()
    {
        var pd = "";
        
        $('[id^=selected_]').each(function() {
            var name = $(this).attr('name');
            var value =  $(this).val();

            if (value>0)
            {   
                pd = pd + name + ": " + value + " - ";
            }
        });

        $('#pedidos').val(pd); 
        console.log($('#pedidos').val());

        document.getElementById("myForm").submit();
        
    }
</script>